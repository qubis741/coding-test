(this["webpackJsonpcoding-test"]=this["webpackJsonpcoding-test"]||[]).push([[0],{12:function(t){t.exports=JSON.parse('[{"id":"A101","description":"Screwdriver","category":"1","price":"9.75"},{"id":"A102","description":"Electric screwdriver","category":"1","price":"49.50"},{"id":"B101","description":"Basic on-off switch","category":"2","price":"4.99"},{"id":"B102","description":"Press button","category":"2","price":"4.99"},{"id":"B103","description":"Switch with motion detector","category":"2","price":"12.95"}]')},36:function(t){t.exports=JSON.parse('{"id":"3","customer-id":"3","items":[{"product-id":"A101","quantity":"2","unit-price":"9.75","total":"19.50"},{"product-id":"A102","quantity":"1","unit-price":"49.50","total":"49.50"}],"total":"69.00"}')},44:function(t,e,r){},51:function(t,e,r){},72:function(t,e,r){"use strict";r.r(e);var n=r(0),i=r.n(n),c=(r(44),r(15)),a=r(40),o=r(3),u=r(41),s=r(11),d=r(2),b="SET_ORDER";var j="ADD_PRODUCT";var l="CHANGE_PRODUCT_QUANTITY";var p="REMOVE_PRODUCT";var O="CLEAR_ORDER";var h=function(t){return Math.round(100*t)/100},f=r(12),m=function(t){var e={};return t.items.forEach((function(t){e[t["product-id"]]=function(t,e){var r=e.find((function(e){return e.id===t["product-id"]}));return{id:t["product-id"],quantity:parseInt(t.quantity),category:r.category,description:r.description,price:parseFloat(r.price),total:parseFloat(t.total)}}(t,f)})),Object(d.a)(Object(d.a)({},t),{},{total:parseFloat(t.total),items:e})},v=function(t){return h(Object.values(t).reduce((function(t,e){return t+e.total}),0))},x={id:"","customer-id":"",items:{},total:0},g=Object(a.a)({reducer:{order:function(t,e){switch(e.type){case b:return Object(d.a)(Object(d.a)({},t),e.order);case j:return function(t,e){if(!t)return t;var r=e.product.id,n=t.items&&t.items[r],i=n?n.quantity+e.quantity:e.quantity,c=Object(d.a)(Object(d.a)({},e.product),{},{price:parseFloat(e.product.price),quantity:i,total:h(e.product.price*i)}),a=Object(d.a)(Object(d.a)({},t.items),{},Object(s.a)({},r,c));return Object(d.a)(Object(d.a)({},t),{},{items:a,total:v(a)})}(t,e);case l:return function(t,e){if(!t)return t;var r=e.product.id,n=t.items[r],i=Object(d.a)(Object(d.a)({},n),{},{quantity:e.newQuantity,total:h(n.price*e.newQuantity)}),c=Object(d.a)(Object(d.a)({},t.items),{},Object(s.a)({},r,i));return Object(d.a)(Object(d.a)({},t),{},{items:c,total:v(c)})}(t,e);case p:return function(t,e){if(!t)return t;var r=t.items,n=e.productId,i=(r[n],Object(o.a)(r,[n].map(u.a)));return Object(d.a)(Object(d.a)({},t),{},{items:i,total:v(i)})}(t,e);case O:return x;default:return t||null}}},preloadedState:{order:null}}),y=function(){return Object(c.b)()},P=c.c,q=r(9),A=r.n(q),w=(r(51),r(10)),C=r(35),E=r.n(C),S=r(18),T=function t(e){var r=this;Object(S.a)(this,t),this.http=e,this.basePath=void 0,this.get=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};return r.http.request({method:"GET",url:r.basePath+t,params:e.queryParams||{}}).then((function(t){return t.data}))},this.post=function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{data:{}};return r.http.request({method:"POST",url:r.basePath+t,params:e.queryParams||{},data:e.data}).then((function(t){return t.data}))},this.basePath=""},R=r(36),N=function t(e){Object(S.a)(this,t),this.api=e,this.basePath="",this.getOrder=function(){return new Promise((function(t){setTimeout((function(){t(R)}),500)}))},this.submitOrder=function(t){return new Promise((function(e,r){setTimeout((function(){console.log("SUBMIT",function(t){var e=Object.values(t.items).map((function(t){return{"product-id":(e=t).id,quantity:e.quantity.toString(),"unit-price":e.price.toString(),total:e.total.toString()};var e}));return Object(d.a)(Object(d.a)({},t),{},{items:e,total:t.total.toString()})}(t)),e()}),500)}))}},D=function(){var t=i.a.createContext(null);return{AppContextProvider:t.Provider,useAppContext:function(){return Object(n.useContext)(t)}}}(),I=D.AppContextProvider,Q=D.useAppContext,B=function(){var t=y(),e=Q().orderApi;Object(n.useEffect)((function(){e.getOrder().then((function(e){var r;t((r=m(e),{type:b,order:r}))}))}),[t,e])},F=function(){var t=y(),e=P((function(t){return t.order})),r=Q().orderApi;return{isLoading:!e,order:e,methods:{addProduct:function(e,r){var n=f.find((function(t){return t.id===e}));t(function(t,e){return{type:j,product:t,quantity:e}}(n,r))},changeProductQuantity:function(e,r){var n=f.find((function(t){return t.id===e}));t(function(t,e){return{type:l,product:t,newQuantity:e}}(n,r))},removeProduct:function(e){return t(function(t){return{type:p,productId:t}}(e))},submitOrder:function(){return r.submitOrder(e).then((function(){t({type:O})}))}}}},U=r(1),M=function(){var t=F().methods.addProduct;return Object(U.jsxs)("div",{className:"all-products",children:[Object(U.jsx)("h2",{children:"All Products"}),Object(U.jsx)("div",{className:"grid",children:f.map((function(e){return Object(U.jsx)("button",{"aria-label":"product-".concat(e.id,"-add"),onClick:function(){return t(e.id,1)},children:"".concat(e.description," - ").concat(e.price)},e.id)}))})]})},_=r(74),k=r(75),J=r(76),L=r(77),G=r(79),V=function(t){var e=t.products,r=t.onQuantityChange,n=t.onRemove;return Object(U.jsx)("div",{children:Object.values(e).map((function(t){return Object(U.jsxs)(_.a,{className:"mb-2","aria-label":"product-".concat(t.id,"-row"),children:[Object(U.jsx)(k.a,{children:Object(U.jsx)("b",{children:t.description})}),Object(U.jsx)(k.a,{children:Object(U.jsx)("input",{type:"number",value:t.quantity,"aria-label":"product-".concat(t.id,"-quantity"),onChange:function(e){var n=parseInt(e.target.value);n>0&&r(t.id,n)},min:"1"})}),Object(U.jsxs)(k.a,{children:["Unit price: ",t.price.toFixed(2)]}),Object(U.jsxs)(k.a,{children:["Total price: ",t.total.toFixed(2)]}),Object(U.jsx)(k.a,{sm:{span:2},children:Object(U.jsx)(J.a,{variant:"danger",onClick:function(){return n(t.id)},"aria-label":"product-".concat(t.id,"-remove"),children:"REMOVE"})})]},t.id)}))})},H=function(){var t=F(),e=t.order,r=t.isLoading,i=t.methods,c=i.changeProductQuantity,a=i.removeProduct,o=i.submitOrder,u=function(){var t=Object(n.useState)({submitting:!1,error:!1,success:!1}),e=Object(w.a)(t,2),r=e[0],i=r.success,c=r.error,a=r.submitting,o=e[1];return{submitting:a,success:i,error:c,submitAction:function(t){o({submitting:!0,success:!1,error:!1}),t().then((function(){return o({submitting:!1,success:!0,error:!1})})).catch((function(){return o({submitting:!1,success:!1,error:!0})}))}}}(),s=u.submitting,d=u.success,b=u.error,j=u.submitAction;return Object(U.jsxs)("div",{children:[Object(U.jsx)("h1",{children:"Order Detail"}),r&&Object(U.jsx)(L.a,{animation:"border"}),e&&Object(U.jsxs)("div",{children:[Object(U.jsx)(V,{products:e.items,onQuantityChange:c,onRemove:a}),Object(U.jsxs)(_.a,{className:"mb-2",children:[Object(U.jsx)(k.a,{sm:{offset:8},children:Object(U.jsxs)("b",{children:["Total: ",e.total.toFixed(2)]})}),Object(U.jsxs)(k.a,{className:"submit-panel",children:[s&&Object(U.jsx)(L.a,{animation:"border"}),!s&&Object(U.jsx)(J.a,{disabled:0===e.total,onClick:function(){return j(o)},children:"SUBMIT"})]})]}),Object(U.jsxs)("div",{children:[d&&Object(U.jsx)(G.a,{variant:"success",children:"Order was submitted!"}),b&&Object(U.jsx)(G.a,{variant:"danger",children:"Error occurred during order submission"})]})]}),Object(U.jsx)(M,{})]})},Y=r(78),z=function(){return B(),Object(U.jsx)(Y.a,{children:Object(U.jsx)(H,{})})},K=function(){var t=E.a.create(),e=new T(t);return{api:e,orderApi:new N(e),http:t}}();A.a.render(Object(U.jsx)(i.a.StrictMode,{children:Object(U.jsx)(c.a,{store:g,children:Object(U.jsx)(I,{value:K,children:Object(U.jsx)(z,{})})})}),document.getElementById("root"))}},[[72,1,2]]]);
//# sourceMappingURL=main.1a09829e.chunk.js.map